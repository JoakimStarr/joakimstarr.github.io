<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°è‹¹æœå’Œå®å®çš„æ‹çˆ±æ—¶é’Ÿ</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #5a3d5c;
      overflow-x: hidden;
      position: relative;
      transition: background 0.8s ease;
    }

    /* å¿ƒå½¢èƒŒæ™¯ */
    .heart-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.3;
      pointer-events: none;
    }

    .heart {
      position: absolute;
      font-size: 20px;
      color: #ff6b8b;
      animation: float 8s infinite ease-in-out;
      pointer-events: none;
      user-select: none;
    }

    /* ä¸»å®¹å™¨ */
    .container {
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(12px);
      border-radius: 24px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      padding: 35px;
      max-width: 650px;
      width: 92%;
      text-align: center;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
      animation: fadeIn 1s ease-out;
    }

    /* æ ‡é¢˜æ ·å¼ */
    .header {
      margin-bottom: 30px;
      position: relative;
    }

    .header h1 {
      font-size: 2.4rem;
      color: #ff6b8b;
      margin-bottom: 12px;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
      font-weight: 700;
    }

    .header p {
      font-size: 1.3rem;
      color: #8a6d8f;
      font-weight: 500;
    }

    /* ç¿»é¡µè®¡æ—¶å™¨æ ·å¼ */
    .flip-timer {
      display: flex;
      justify-content: center;
      margin: 35px 0;
      flex-wrap: wrap;
      gap: 20px;
    }

    .flip-unit {
      text-align: center;
    }

    .flip-container {
      position: relative;
      width: 100px;
      height: 120px;
      perspective: 800px;
      margin: 0 auto 10px;
    }

    .flip-card {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .flip-card.flipping {
      transform: rotateX(180deg);
    }

    .flip-front,
    .flip-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3.5rem;
      font-weight: bold;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .flip-front {
      background: white;
      color: #ff6b8b;
    }

    .flip-back {
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      color: white;
      transform: rotateX(180deg);
    }

    .flip-label {
      font-size: 1.2rem;
      color: #8a6d8f;
      font-weight: 500;
      margin-top: 8px;
      text-align: center;
      font-weight: bold;
    }

    /* çºªå¿µæ—¥éƒ¨åˆ† */
    .milestone {
      margin: 30px 0;
      padding: 20px;
      background: rgba(255, 235, 238, 0.75);
      border-radius: 18px;
      font-size: 1.2rem;
      border: 1px solid rgba(255, 182, 193, 0.3);
    }

    /* æŒ‰é’®æ ·å¼ */
    .btn-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
    }

    .btn {
      background: #ff6b8b;
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 50px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 18px rgba(255, 107, 139, 0.4);
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }

    .btn:hover {
      background: #ff8fa3;
      transform: translateY(-4px);
      box-shadow: 0 10px 25px rgba(255, 107, 139, 0.6);
    }

    .btn:active {
      transform: translateY(-1px);
    }

    /* åŠ¨ç”» */
    @keyframes float {
      0%, 100% {
        transform: translateY(0) rotate(0deg);
      }
      50% {
        transform: translateY(-25px) rotate(5deg);
      }
    }

    @keyframes heartbeat {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.15);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .heartbeat {
      animation: heartbeat 1.5s infinite;
      display: inline-block;
      margin: 0 10px;
      color: #ff6b8b;
    }

    /* äºŒç»´ç å¼¹çª—æ ·å¼ - æ ¹æ®å›¾ç‰‡æ ·å¼ä¼˜åŒ– */
    .qrcode-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 10000;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s ease-out;
    }

    .qrcode-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      text-align: center;
      max-width: 320px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
      position: relative;
      animation: popIn 0.4s ease-out;
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 20px;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #999;
      transition: color 0.3s;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      background: #f5f5f5;
      color: #ff6b8b;
    }

    .modal-title {
      color: #ff6b8b;
      font-size: 1.4rem;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .modal-message {
      color: #333;
      font-size: 1.1rem;
      line-height: 1.5;
      margin-bottom: 10px;
    }

    .modal-message .love-days {
      color: #ff6b8b;
      font-weight: bold;
    }

    .modal-heart {
      color: #ff6b8b;
      font-size: 1.2rem;
      margin: 0 5px;
    }

    .modal-continue {
      color: #666;
      font-size: 1rem;
      margin-bottom: 20px;
    }

    #qrcode {
      margin: 15px auto;
      width: 200px;
      height: 200px;
      display: flex;
      justify-content: center;
      align-items: center;
      background: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }

    .modal-tip {
      font-size: 0.9rem;
      color: #666;
      margin: 15px 0 20px;
    }

    .download-btn {
      background: #ff6b8b;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 107, 139, 0.4);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      width: auto;
      margin: 0 auto;
    }

    .download-btn:hover {
      background: #ff8fa3;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(255, 107, 139, 0.5);
    }

    @keyframes popIn {
      0% {
        opacity: 0;
        transform: scale(0.8);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .container {
        padding: 25px 20px;
        border-radius: 20px;
        width: 95%;
      }

      .header h1 {
        font-size: 2rem;
      }

      .header p {
        font-size: 1.1rem;
      }

      .flip-timer {
        gap: 15px;
        margin: 25px 0;
      }

      .flip-container {
        width: 80px;
        height: 100px;
      }

      .flip-front, .flip-back {
        font-size: 2.8rem;
      }

      .flip-label {
        font-size: 1rem;
      }

      .btn {
        padding: 12px 20px;
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      .flip-container {
        width: 70px;
        height: 85px;
      }

      .flip-front, .flip-back {
        font-size: 2.2rem;
      }

      .flip-unit {
        flex: 0 0 45%;
        margin-bottom: 15px;
      }

      .flip-timer {
        gap: 10px;
      }

      .flip-label {
        font-size: 0.9rem;
      }

      .btn-container {
        flex-direction: column;
        align-items: center;
      }

      .btn {
        width: 100%;
        max-width: 200px;
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <!-- å¿ƒå½¢èƒŒæ™¯ -->
  <div class="heart-bg" id="heartBg"></div>

  <!-- ä¸»å®¹å™¨ -->
  <div class="container">
    <div class="header">
      <h1><i class="fas fa-heart heartbeat"></i> å°è‹¹æœå’Œå®å® <i class="fas fa-heart heartbeat"></i></h1>
      <p>å·²ç»åœ¨ä¸€èµ·åº¦è¿‡äº†ï¼š</p>
    </div>

    <!-- ç¿»é¡µè®¡æ—¶å™¨ -->
    <div class="flip-timer">
      <div class="flip-unit">
        <div class="flip-container" id="flip-days">
          <div class="flip-card">
            <div class="flip-front">0</div>
            <div class="flip-back">0</div>
          </div>
        </div>
        <div class="flip-label">å¤©</div>
      </div>
      
      <div class="flip-unit">
        <div class="flip-container" id="flip-hours">
          <div class="flip-card">
            <div class="flip-front">00</div>
            <div class="flip-back">00</div>
          </div>
        </div>
        <div class="flip-label">å°æ—¶</div>
      </div>
      
      <div class="flip-unit">
        <div class="flip-container" id="flip-minutes">
          <div class="flip-card">
            <div class="flip-front">00</div>
            <div class="flip-back">00</div>
          </div>
        </div>
        <div class="flip-label">åˆ†é’Ÿ</div>
      </div>
      
      <div class="flip-unit">
        <div class="flip-container" id="flip-seconds">
          <div class="flip-card">
            <div class="flip-front">00</div>
            <div class="flip-back">00</div>
          </div>
        </div>
        <div class="flip-label">ç§’</div>
      </div>
    </div>

    <div class="milestone" id="milestone">
      <!-- çºªå¿µæ—¥ä¿¡æ¯ä¼šåŠ¨æ€æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
    </div>

    <div class="btn-container">
      <button class="btn" id="themeBtn">
        <i class="fas fa-palette"></i> åˆ‡æ¢ä¸»é¢˜
      </button>
      <button class="btn" id="shareBtn">
        <i class="fas fa-share-alt"></i> åˆ†äº«ç”œèœœ
      </button>
    </div>
  </div>

  <!-- äºŒç»´ç å¼¹çª— - æ ¹æ®å›¾ç‰‡æ ·å¼è®¾è®¡ -->
  <div class="qrcode-modal" id="qrcodeModal">
    <div class="qrcode-content">
      <button class="modal-close" id="modalClose">&times;</button>
      <h2 class="modal-title">åˆ†äº«æˆ‘ä»¬çš„çˆ±</h2>
      <p class="modal-message">
        å°è‹¹æœå’Œå®å®å·²ç»ç›¸çˆ±<span class="love-days" id="loveDays">115</span>å¤©äº†<span class="modal-heart">ğŸ’–</span>
      </p>
      <p class="modal-continue">æˆ‘ä»¬çš„çˆ±è¿˜åœ¨ç»§ç»­...</p>
      <div id="qrcode"></div>
      <p class="modal-tip">æ‰«æäºŒç»´ç ï¼Œåˆ†äº«ç”œèœœ</p>
      <button class="download-btn" id="downloadBtn">
        <i class="fas fa-download"></i> ä¸‹è½½äºŒç»´ç 
      </button>
    </div>
  </div>

  <script>
    // è®¾ç½®æ‹çˆ±å¼€å§‹çš„æ—¥æœŸå’Œæ—¶é—´
    const startDate = new Date('2025-09-04T00:00:00');

    // çºªå¿µæ—¥æ•°æ®
    const milestones = [
      { days: 100, name: "ğŸ’ æ‹çˆ±100å¤©", message: "ç™¾åˆ†ç™¾çš„çˆ±ç»™ä½ ï¼" },
      { days: 200, name: "ğŸŒ¹ æ‹çˆ±200å¤©", message: "çˆ±æ„å¦‚ç«ç‘°ç»½æ”¾ï¼" },
      { days: 365, name: "ğŸ‰ æ‹çˆ±ä¸€å‘¨å¹´", message: "å‘¨å¹´å¿«ä¹ï¼" },
      { days: 520, name: "ğŸ’– æ‹çˆ±520å¤©", message: "æˆ‘çˆ±ä½ ï¼" },
      { days: 999, name: "ğŸŒŸ æ‹çˆ±999å¤©", message: "é•¿é•¿ä¹…ä¹…ï¼" }
    ];

    // ä¸»é¢˜é¢œè‰²
    const themes = [
      {
        primary: "#ff6b8b",
        secondary: "#8a6d8f",
        bg: "linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%)",
        heart: "#ff6b8b"
      },
      {
        primary: "#6a8caf",
        secondary: "#4a6572",
        bg: "linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%)",
        heart: "#6a8caf"
      },
      {
        primary: "#6b5b95",
        secondary: "#4b3b6d",
        bg: "linear-gradient(135deg, #d9a7c7 0%, #fffcdc 100%)",
        heart: "#6b5b95"
      },
      {
        primary: "#44a08d",
        secondary: "#2d6a6d",
        bg: "linear-gradient(135deg, #a8ff78 0%, #78ffd6 100%)",
        heart: "#44a08d"
      },
      {
        primary: "#e65c78",
        secondary: "#8a4b6e",
        bg: "linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%)",
        heart: "#e65c78"
      }
    ];

    let currentTheme = 0;
    let animationFrameId = null;
    let qrcodeInstance = null;
    
    // å­˜å‚¨å½“å‰æ—¶é—´å€¼
    let currentValues = {
      days: "0",
      hours: "00",
      minutes: "00",
      seconds: "00"
    };

    // åˆå§‹åŒ–å¿ƒå½¢èƒŒæ™¯
    function initHeartBackground() {
      const heartBg = document.getElementById('heartBg');
      const heartCount = Math.min(40, Math.floor((window.innerWidth * window.innerHeight) / 15000));

      heartBg.innerHTML = '';

      for (let i = 0; i < heartCount; i++) {
        const heart = document.createElement('div');
        heart.innerHTML = 'â¤';
        heart.classList.add('heart');

        heart.style.left = `${Math.random() * 100}%`;
        heart.style.top = `${Math.random() * 100}%`;
        heart.style.animationDelay = `${Math.random() * 12}s`;
        heart.style.animationDuration = `${6 + Math.random() * 10}s`;
        const size = 16 + Math.random() * 12;
        heart.style.fontSize = `${size}px`;

        heartBg.appendChild(heart);
      }
    }

    // å¯åŠ¨è®¡æ—¶å™¨
    function startLoveTimer() {
      let lastTime = Date.now();

      function update() {
        const now = Date.now();
        const diff = now - lastTime;

        if (diff >= 900) {
          updateLoveTimer();
          lastTime = now;
        }

        animationFrameId = requestAnimationFrame(update);
      }

      animationFrameId = requestAnimationFrame(update);
    }

    // æ›´æ–°è®¡æ—¶å™¨
    function updateLoveTimer() {
      const now = new Date();
      const diff = now - startDate;

      // è®¡ç®—æ—¶é—´å·®
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((diff / (1000 * 60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);

      // æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²
      const daysStr = days.toString();
      const hoursStr = hours.toString().padStart(2, '0');
      const minutesStr = minutes.toString().padStart(2, '0');
      const secondsStr = seconds.toString().padStart(2, '0');

      // æ›´æ–°ç¿»é¡µè®¡æ—¶å™¨
      flipUpdate('days', daysStr);
      flipUpdate('hours', hoursStr);
      flipUpdate('minutes', minutesStr);
      flipUpdate('seconds', secondsStr);

      // å­˜å‚¨å½“å‰å€¼
      currentValues = {
        days: daysStr,
        hours: hoursStr,
        minutes: minutesStr,
        seconds: secondsStr
      };

      // æ£€æŸ¥å¹¶æ˜¾ç¤ºçºªå¿µæ—¥
      checkMilestone(days);
    }

    // ç¿»é¡µæ›´æ–°å‡½æ•°
    function flipUpdate(unit, newValue) {
      const container = document.getElementById(`flip-${unit}`);
      if (!container) return;
      
      const card = container.querySelector('.flip-card');
      const front = container.querySelector('.flip-front');
      const back = container.querySelector('.flip-back');
      
      // è·å–å½“å‰å€¼
      const currentValue = front.textContent;
      
      // åªæœ‰å½“å€¼æ”¹å˜æ—¶æ‰è§¦å‘ç¿»é¡µåŠ¨ç”»
      if (currentValue !== newValue) {
        // å…ˆè®¾ç½®èƒŒé¢çš„å€¼
        back.textContent = newValue;
        
        // è§¦å‘ç¿»é¡µåŠ¨ç”»
        card.classList.add('flipping');
        
        // åŠ¨ç”»ç»“æŸåæ›´æ–°æ­£é¢çš„å€¼å¹¶é‡ç½®åŠ¨ç”»
        setTimeout(() => {
          front.textContent = newValue;
          card.classList.remove('flipping');
        }, 600); // ä¸CSSä¸­çš„transitionæ—¶é—´åŒ¹é…
      }
    }

    // æ£€æŸ¥çºªå¿µæ—¥
    function checkMilestone(days) {
      const milestoneElement = document.getElementById('milestone');
      let nextMilestone = null;
      let achievedMilestone = null;

      for (const milestone of milestones) {
        if (days >= milestone.days) {
          achievedMilestone = milestone;
        } else if (!nextMilestone) {
          nextMilestone = milestone;
          break;
        }
      }

      if (achievedMilestone && (!nextMilestone || days - achievedMilestone.days < 7)) {
        milestoneElement.innerHTML = `
          <i class="fas fa-crown"></i> 
          å·²åº†ç¥ <strong>${achievedMilestone.name}</strong>ï¼
          <br><small>${achievedMilestone.message}</small>
        `;
        milestoneElement.style.background = 'rgba(255, 215, 0, 0.7)';
      } else if (nextMilestone) {
        const daysLeft = nextMilestone.days - days;
        milestoneElement.innerHTML = `
          <i class="fas fa-gift"></i> 
          è·ç¦» <strong>${nextMilestone.name}</strong> è¿˜æœ‰ <strong>${daysLeft}</strong> å¤©
          <br><small>${nextMilestone.message}</small>
        `;
        milestoneElement.style.background = 'rgba(255, 235, 238, 0.75)';
      } else {
        const lastMilestone = milestones[milestones.length - 1];
        milestoneElement.innerHTML = `
          <i class="fas fa-infinity"></i> 
          çˆ±æ„æŒç»­å¢é•¿ä¸­...
          <br><small>å·²è¶…è¶Š ${lastMilestone.name}ï¼</small>
        `;
        milestoneElement.style.background = 'rgba(200, 230, 255, 0.75)';
      }
    }

    // åˆ‡æ¢ä¸»é¢˜
    function changeTheme() {
      currentTheme = (currentTheme + 1) % themes.length;
      const theme = themes[currentTheme];

      // æ›´æ–°èƒŒæ™¯
      document.body.style.background = theme.bg;

      // æ›´æ–°æ•°å­—é¢œè‰²
      const flipNumbers = document.querySelectorAll('.flip-front, .flip-back');
      flipNumbers.forEach(number => {
        number.style.color = theme.primary;
      });

      // æ›´æ–°æŒ‰é’®é¢œè‰²
      const buttons = document.querySelectorAll('.btn, .download-btn');
      buttons.forEach(button => {
        button.style.background = theme.primary;
      });

      // æ›´æ–°å¿ƒå½¢é¢œè‰²
      const hearts = document.querySelectorAll('.heart');
      hearts.forEach(heart => {
        heart.style.color = theme.heart;
      });

      // æ›´æ–°æ ‡é¢˜é¢œè‰²
      const headers = document.querySelectorAll('.header h1, .modal-title');
      headers.forEach(header => {
        header.style.color = theme.primary;
      });

      // æ›´æ–°ç¿»é¡µèƒŒé¢èƒŒæ™¯
      const flipBacks = document.querySelectorAll('.flip-back');
      flipBacks.forEach(flipBack => {
        flipBack.style.background = theme.bg;
      });
    }

    // åˆ†äº«åŠŸèƒ½
    function shareLove() {
      const shareUrl = window.location.href;
      
      // æ›´æ–°å¼¹çª—ä¸­çš„å¤©æ•°æ˜¾ç¤º
      document.getElementById('loveDays').textContent = currentValues.days;
      
      // æ˜¾ç¤ºäºŒç»´ç å¼¹çª—
      showQRCodeModal(shareUrl);
    }

    // æ˜¾ç¤ºäºŒç»´ç å¼¹çª—
    function showQRCodeModal(url) {
      const modal = document.getElementById('qrcodeModal');
      const qrcodeContainer = document.getElementById('qrcode');
      
      // æ¸…ç©ºå®¹å™¨
      qrcodeContainer.innerHTML = '';
      
      // æ˜¾ç¤ºå¼¹çª—
      modal.style.display = 'flex';
      
      // ä½¿ç”¨QRCode.jsç”ŸæˆäºŒç»´ç 
      try {
        // å¦‚æœå·²æœ‰å®ä¾‹ï¼Œå…ˆé”€æ¯
        if (qrcodeInstance) {
          qrcodeContainer.innerHTML = '';
        }
        
        // åˆ›å»ºæ–°çš„äºŒç»´ç 
        qrcodeInstance = new QRCode(qrcodeContainer, {
          text: url,
          width: 180,
          height: 180,
          colorDark: themes[currentTheme].primary,
          colorLight: "#ffffff",
          correctLevel: QRCode.CorrectLevel.H
        });
        
      } catch (error) {
        console.error('QRCodeåº“åŠ è½½å¤±è´¥:', error);
        qrcodeContainer.innerHTML = '<p style="color:red; padding: 20px;">ç”ŸæˆäºŒç»´ç å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ã€‚</p>';
      }
    }

    // ä¸‹è½½äºŒç»´ç 
    function downloadQRCode() {
      const canvas = document.querySelector('#qrcode canvas');
      if (canvas) {
        const link = document.createElement('a');
        link.download = 'æ‹çˆ±æ—¶é’ŸäºŒç»´ç .png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      } else {
        alert('è¯·å…ˆç”ŸæˆäºŒç»´ç ï¼');
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.addEventListener('DOMContentLoaded', () => {
      initHeartBackground();
      updateLoveTimer();
      startLoveTimer();

      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      document.getElementById('themeBtn').addEventListener('click', changeTheme);
      document.getElementById('shareBtn').addEventListener('click', shareLove);
      
      // äºŒç»´ç å¼¹çª—å…³é—­æŒ‰é’®
      document.getElementById('modalClose').addEventListener('click', () => {
        document.getElementById('qrcodeModal').style.display = 'none';
      });
      
      // ä¸‹è½½äºŒç»´ç æŒ‰é’®
      document.getElementById('downloadBtn').addEventListener('click', downloadQRCode);
      
      // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
      document.getElementById('qrcodeModal').addEventListener('click', (e) => {
        if (e.target.id === 'qrcodeModal') {
          document.getElementById('qrcodeModal').style.display = 'none';
        }
      });

      // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°åˆå§‹åŒ–å¿ƒå½¢èƒŒæ™¯
      let resizeTimeout;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          initHeartBackground();
        }, 250);
      });
    });

    // é¡µé¢å¸è½½æ—¶æ¸…ç†èµ„æº
    window.addEventListener('beforeunload', () => {
      if (animationFrameId) {
        cancelAnimationFrame(animationFrameId);
      }
    });
  </script>
</body>
</html>
